(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[837],{405:function(t,e,n){"use strict";n.r(e),n.d(e,{contentTitle:function(){return nt},default:function(){return ct},frontMatter:function(){return et},metadata:function(){return rt},toc:function(){return at}});var r=n(5773),a=n(808),o=n(7378),c=n(5318),s=n(7807),i=n(6431),l=n(8549),u=n(7791),d=n(7135),p=n.n(d),f=n(9576),m=n(8282),v=n(4051);function h(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var k=(0,o.createContext)(void 0);function b(){return(0,o.useContext)(k)}var g={account:void 0,hasStarknet:!1,connectBrowserWallet:function(){},library:f.defaultProvider},E=(0,o.createContext)(g);function y(){return(0,o.useContext)(E)}function _(t,e){switch(e.type){case"set_account":return Object.assign({},t,{account:e.account});case"set_provider":return Object.assign({},t,{library:e.provider});case"set_error":return Object.assign({},t,{error:e.error});default:return t}}function C(t){var e=t.children,n=function(){var t=(0,o.useState)(!1),e=t[0],n=t[1],r=(0,o.useReducer)(_,{library:f.defaultProvider}),a=r[0],c=r[1],s=a.account,i=a.library,l=a.error;return(0,o.useEffect)((function(){"uninstalled"!==(0,m.k)().version&&n(!0)}),[]),{account:s,hasStarknet:e,connectBrowserWallet:(0,o.useCallback)((0,u.Z)(p().mark((function t(){var e,n,r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,void 0!==window.starknet){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,window.starknet.enable();case 5:e=t.sent,n=e[0],c({type:"set_account",account:n}),(r=(0,m.k)()).signer&&c({type:"set_provider",provider:r.signer}),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0),c({type:"set_error",error:"could not activate StarkNet"});case 16:case"end":return t.stop()}}),t,null,[[0,12]])}))),[]),library:i,error:l}}();return o.createElement(E.Provider,{value:n},e)}function w(t){var e=t.interval,n=t.children,r=y().library,a=(0,o.useState)(void 0),c=a[0],s=a[1],i=(0,o.useState)(void 0),l=i[0],u=i[1],d=(0,o.useState)(void 0),p=d[0],f=d[1],m=(0,o.useCallback)((function(){r&&(u(!0),r.getBlock().then(s).catch((function(){f("failed fetching block")})).finally((function(){return u(!1)})))}),[r,u,f,s]);return(0,o.useEffect)((function(){m();var t=setInterval((function(){m()}),null!=e?e:5e3);return function(){return clearInterval(t)}}),[m,e]),o.createElement(k.Provider,{value:{data:c,loading:l,error:p}},n)}var x={transactions:[],addTransaction:function(t){},removeTransaction:function(t){},refreshTransaction:function(t){}},N=(0,o.createContext)(x);function S(){return(0,o.useContext)(N)}function T(t,e){if("add_transaction"===e.type)return Object.assign({},t,{transactions:t.transactions.push(e.transaction)});if("remove_transaction"===e.type)return Object.assign({},t,{transactions:t.transactions.filter((function(t){return t.transactionHash!==e.transactionHash}))});if("update_transaction"===e.type){if("NOT_RECEIVED"===e.transactionResponse.status)return t;var n=t.transactions.findEntry((function(t){return t.transactionHash===e.transactionResponse.transaction.transaction_hash}));if(!n)return t;var r=n[0],a=(n[1],{status:e.transactionResponse.status,transaction:e.transactionResponse.transaction,transactionHash:e.transactionResponse.transaction.transaction_hash,lastUpdatedAt:e.lastUpdatedAt});return Object.assign({},t,{transactions:t.transactions.set(r,a)})}return t}function R(t,e){return"TRANSACTION_RECEIVED"===t.status||"ACCEPTED_ON_L1"!==t.status&&"REJECTED"!==t.status&&("ACCEPTED_ON_L2"===t.status?e-t.lastUpdatedAt>12e4:e-t.lastUpdatedAt>15e3)}function O(t){var e=t.children,n=t.interval,r=y().library,a=(0,o.useReducer)(T,{transactions:(0,v.aV)()}),c=a[0],s=a[1],i=(0,o.useCallback)(function(){var t=(0,u.Z)(p().mark((function t(e){var n,a;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.getTransaction(e);case 3:n=t.sent,a=Date.now(),s({type:"update_transaction",transactionResponse:n,lastUpdatedAt:a}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),[r,s]),d=(0,o.useCallback)((function(){for(var t,e=Date.now(),n=(0,l.Z)(c.transactions);!(t=n()).done;){var r=t.value;R(r,e)&&i(r.transactionHash)}}),[c.transactions,i]),f=(0,o.useCallback)((function(t){s({type:"add_transaction",transaction:t})}),[s]),m=(0,o.useCallback)((function(t){s({type:"remove_transaction",transactionHash:t})}),[s]),h=(0,o.useCallback)((function(t){i(t)}),[i]);return(0,o.useEffect)((function(){d();var t=setInterval((function(){d()}),null!=n?n:5e3);return function(){return clearInterval(t)}}),[n,d]),o.createElement(N.Provider,{value:{transactions:c.transactions.toArray(),addTransaction:f,removeTransaction:m,refreshTransaction:h}},e)}function A(t){var e=t.children;return o.createElement(C,null,o.createElement(w,null,o.createElement(O,null,e)))}var D={};function j(t,e){return"set_call_response"===e.type?Object.assign({},t,{data:e.data,error:void 0,loading:!1}):"set_call_error"===e.type?Object.assign({},t,{error:e.error,loading:!1}):"set_last_updated_at"===e.type?Object.assign({},t,{loading:!1,lastUpdatedAt:e.blockHash}):t}function H(t){var e=t.contract,n=t.method,r=t.args,a=(0,o.useReducer)(j,{loading:!0,lastUpdatedAt:""}),c=a[0],s=a[1],i=b().data,l=(0,o.useCallback)((0,u.Z)(p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e&&n&&r)){t.next=4;break}return t.next=3,e.call(n,r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),[e,n,JSON.stringify(r)]),d=(0,o.useCallback)((function(){l().then((function(t){t&&s({type:"set_call_response",data:t})})).catch((function(t){t.message?s({type:"set_call_error",error:t.message}):s({type:"set_call_error",error:"call failed"})}))}),[l]);return(0,o.useEffect)((function(){null!=i&&i.block_hash&&(null==i?void 0:i.block_hash)!==c.lastUpdatedAt&&(d(),s({type:"set_last_updated_at",blockHash:i.block_hash}))}),[null==i?void 0:i.block_hash,c.lastUpdatedAt,d]),(0,o.useEffect)((function(){d()}),[null==e?void 0:e.connectedTo,n,JSON.stringify(r)]),{data:c.data,loading:c.loading,error:c.error,refresh:d}}function I(t){var e=t.abi,n=t.address,r=(0,o.useState)(void 0),a=r[0],c=r[1],s=y().library;return(0,o.useEffect)((function(){e&&n&&s&&c(new f.Contract(e,n,s))}),[e,n,s]),{contract:a}}function M(t,e){return"start_invoke"===e.type?Object.assign({},t,{loading:!0}):"set_invoke_response"===e.type?Object.assign({},t,{data:e.data.transaction_hash,error:void 0,loading:!1}):"set_invoke_error"===e.type?Object.assign({},t,{error:e.error,loading:!1}):"reset"===e.type?Object.assign({},t,{data:void 0,error:void 0,loading:!1}):t}function B(t){var e=t.contract,n=t.method,r=S().addTransaction,a=(0,o.useReducer)(M,{loading:!1}),c=a[0],s=a[1],i=(0,o.useCallback)((function(){s({type:"reset"})}),[s]),l=(0,o.useCallback)(function(){var t=(0,u.Z)(p().mark((function t(a){var o,c;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=a.args,!(e&&n&&o)){t.next=13;break}return t.prev=2,t.next=5,e.invoke(n,o);case 5:c=t.sent,s({type:"set_invoke_response",data:c}),r({status:c.code,transactionHash:c.transaction_hash}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),t.t0.message?s({type:"set_invoke_error",error:t.t0.message}):s({type:"set_invoke_error",error:"invoke failed"});case 13:return t.abrupt("return",void 0);case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}(),[e,n,r]);return{data:c.data,loading:c.loading,error:c.error,reset:i,invoke:l}}h(D,"useStarknetCall",(function(){return H})),h(D,"useContract",(function(){return I})),h(D,"useStarknetInvoke",(function(){return B}));var P=JSON.parse('[{"inputs":[{"name":"amount","type":"felt"}],"name":"incrementCounter","outputs":[{"name":"prev_count","type":"felt"},{"name":"new_count","type":"felt"}],"type":"function"},{"inputs":[],"name":"counter","outputs":[{"name":"count","type":"felt"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"lastCaller","outputs":[{"name":"address","type":"felt"}],"stateMutability":"view","type":"function"}]'),U=(0,s.zo)("div",{display:"flex",flexDirection:"column"}),z=(0,s.zo)("div",{}),Z=(0,s.zo)("h3",{}),L=(0,s.zo)("div",{display:"flex",justifyContent:"flex-start",gap:"4rem",marginBottom:"2rem"}),V=(0,s.zo)("button",{background:"transparent",border:"1px solid var(--ifm-color-primary)",padding:"1rem",borderRadius:"10px",cursor:"pointer","&:hover":{boxShadow:"0px 5px 5px rgba(0, 0, 0, 0.2)"}});function X(){return I({abi:P,address:"0x036486801b8f42e950824cba55b2df8cccb0af2497992f807a7e1d9abd2c6ba1"})}function J(){var t=y().hasStarknet;return o.createElement(z,null,o.createElement(Z,null,"Detect StarkNet Wallet"),o.createElement("div",null,t?o.createElement("p",null,"Plugin is installed"):o.createElement("p",null,"Plugin is not installed")))}function W(){var t=y(),e=t.account,n=t.connectBrowserWallet,r=t.hasStarknet;return o.createElement(z,null,o.createElement(Z,null,"Account"),o.createElement("div",null,o.createElement("p",null,"Connected Account: ",e)),r?o.createElement(L,null,o.createElement(V,{onClick:n},"Connect Argent-X")):o.createElement("div",null,o.createElement("p",null,o.createElement("a",{href:"https://github.com/argentlabs/argent-x"},"Download Argent-X"))))}function G(){var t=b(),e=t.data,n=t.error;return o.createElement(z,null,o.createElement(Z,null,"Block Data"),e?o.createElement("div",null,o.createElement("p",null,"Block Hash: ",e.block_hash),o.createElement("p",null,"Block Timestamp: ",new Date(1e3*e.timestamp).toLocaleString())):n?o.createElement("p",null,"'Error loading block data'"):o.createElement("p",null,"'Loading'"))}function Y(){var t=H({contract:X().contract,method:"counter",args:{}}),e=t.data,n=t.error;return o.createElement(z,null,o.createElement(Z,null,"Contract Call"),e?o.createElement("div",null,o.createElement("p",null,"Counter Value: ",(0,i.toBN)(e.count).toString())):n?o.createElement("p",null,"'Error loading counter'"):o.createElement("p",null,"'Loading'"))}function q(){var t=B({contract:X().contract,method:"incrementCounter"}),e=t.data,n=t.loading,r=t.error,a=t.reset,c=t.invoke;return o.createElement(z,null,o.createElement(Z,null,"Invoke Contract Method"),o.createElement("div",null,e&&o.createElement("div",null,o.createElement("p",null,"Transaction Hash: ",e))),o.createElement("div",null,o.createElement("p",null,"Submitting: ",n?"Submitting":"Not Submitting"),o.createElement("p",null,"Error: ",r||"No error")),o.createElement(L,null,o.createElement(V,{onClick:function(){return c({args:{amount:"0x1"}})}},"Invoke Method"),o.createElement(V,{onClick:function(){return a()}},"Reset State")))}function F(t){var e=t.transaction,n=t.onClick;return o.createElement("div",null,e.status,": ",e.transactionHash," ",o.createElement("button",{onClick:n},"remove"))}function K(){var t=S(),e=t.transactions,n=t.removeTransaction;return o.createElement(z,null,o.createElement(Z,null,"Transaction Manager"),o.createElement("div",null,0===e.length?"No transactions":e.map((function(t,e){return o.createElement(F,{key:e,transaction:t,onClick:function(){return n(t.transactionHash)}})}))))}function Q(){return o.createElement(U,null,o.createElement(J,null),o.createElement(W,null),o.createElement(G,null),o.createElement(Y,null),o.createElement(q,null),o.createElement(K,null))}function $(){return o.createElement(A,null,o.createElement(Q,null))}var tt=["components"],et={},nt="StarkNet React Demo",rt={unversionedId:"demo",id:"demo",title:"StarkNet React Demo",description:"This demo shows how to combine the hooks provided by StarkNet React to",source:"@site/docs/demo.mdx",sourceDirName:".",slug:"/demo",permalink:"/starknet-react/demo",editUrl:"https://github.com/auclantis/starknet-react/tree/main/website/docs/demo.mdx",tags:[],version:"current",frontMatter:{}},at=[],ot={toc:at};function ct(t){var e=t.components,n=(0,a.Z)(t,tt);return(0,c.kt)("wrapper",(0,r.Z)({},ot,n,{components:e,mdxType:"MDXLayout"}),(0,c.kt)("h1",{id:"starknet-react-demo"},"StarkNet React Demo"),(0,c.kt)("p",null,"This demo shows how to combine the hooks provided by StarkNet React to\nbuild React applications."),(0,c.kt)("p",null,"The demo interacts with a simple smart contract deployed on StarkNet G\xf6rli Testnet.\nYou can find the contract ",(0,c.kt)("a",{parentName:"p",href:"https://goerli.voyager.online/contract/0x036486801b8f42e950824cba55b2df8cccb0af2497992f807a7e1d9abd2c6ba1"},"on Voyager"),"."),(0,c.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,c.kt)("div",{parentName:"div",className:"admonition-heading"},(0,c.kt)("h5",{parentName:"div"},(0,c.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,c.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,c.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,c.kt)("div",{parentName:"div",className:"admonition-content"},(0,c.kt)("p",{parentName:"div"},"If you try to invoke the ",(0,c.kt)("inlineCode",{parentName:"p"},"incrementCounter")," method without first connecting Argent-X,\nthe transaction will fail instantly."))),(0,c.kt)($,{mdxType:"Demo"}))}ct.isMDXComponent=!0},5545:function(){},6047:function(){},4886:function(){}}]);