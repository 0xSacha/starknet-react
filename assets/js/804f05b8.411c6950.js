(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[837],{405:function(t,e,n){"use strict";n.r(e),n.d(e,{contentTitle:function(){return ut},default:function(){return pt},frontMatter:function(){return st},metadata:function(){return lt},toc:function(){return dt}});var r=n(5773),a=n(808),o=n(7378),c=n(5318),i=n(7807),s=n(290),u=n(3219),l=n(8953),d=n(8549),f=n(7791),p=n(7135),m=n.n(p),v=n(9576),h=n(4051),k=n(8282);function b(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var g=(0,o.createContext)(void 0);function E(){return(0,o.useContext)(g)}var y={account:void 0,connect:function(){},library:v.defaultProvider},C=(0,o.createContext)(y);function _(){return(0,o.useContext)(C)}function w(t,e){switch(e.type){case"set_account":return Object.assign({},t,{account:e.account});case"set_provider":return Object.assign({},t,{library:e.provider});case"set_error":return Object.assign({},t,{error:e.error});default:return t}}function x(t){var e=t.children,n=function(){var t=(0,o.useReducer)(w,{library:v.defaultProvider}),e=t[0],n=t[1],r=e.account,a=e.library,c=e.error;return{account:r,connect:(0,o.useCallback)((function(t){t.connect().then((function(t){n({type:"set_account",account:t.address}),n({type:"set_provider",provider:t})}),(function(t){console.error(t),n({type:"set_error",error:"could not activate StarkNet"})}))}),[]),library:a,error:c}}();return o.createElement(C.Provider,{value:n},e)}function N(t){var e=t.interval,n=t.children,r=_().library,a=(0,o.useState)(void 0),c=a[0],i=a[1],s=(0,o.useState)(void 0),u=s[0],l=s[1],d=(0,o.useState)(void 0),f=d[0],p=d[1],m=(0,o.useCallback)((function(){r&&(l(!0),r.getBlock().then(i).catch((function(){p("failed fetching block")})).finally((function(){return l(!1)})))}),[r,l,p,i]);return(0,o.useEffect)((function(){m();var t=setInterval((function(){m()}),null!=e?e:5e3);return function(){return clearInterval(t)}}),[m,e]),o.createElement(g.Provider,{value:{data:c,loading:u,error:f}},n)}var R={transactions:[],addTransaction:function(t){},removeTransaction:function(t){},refreshTransaction:function(t){}},T=(0,o.createContext)(R);function S(){return(0,o.useContext)(T)}function A(t,e){if("add_transaction"===e.type)return Object.assign({},t,{transactions:t.transactions.push(e.transaction)});if("remove_transaction"===e.type)return Object.assign({},t,{transactions:t.transactions.filter((function(t){return t.transactionHash!==e.transactionHash}))});if("update_transaction"===e.type){if("NOT_RECEIVED"===e.transactionResponse.status)return t;var n=t.transactions.findEntry((function(t){return t.transactionHash===e.transactionResponse.transaction.transaction_hash}));if(!n)return t;var r=n[0],a=(n[1],{status:e.transactionResponse.status,transaction:e.transactionResponse.transaction,transactionHash:e.transactionResponse.transaction.transaction_hash,lastUpdatedAt:e.lastUpdatedAt});return Object.assign({},t,{transactions:t.transactions.set(r,a)})}return t}function O(t,e){return"TRANSACTION_RECEIVED"===t.status||"ACCEPTED_ON_L1"!==t.status&&"REJECTED"!==t.status&&("ACCEPTED_ON_L2"===t.status?e-t.lastUpdatedAt>12e4:e-t.lastUpdatedAt>15e3)}function j(t){var e=t.children,n=t.interval,r=_().library,a=(0,o.useReducer)(A,{transactions:(0,h.aV)()}),c=a[0],i=a[1],s=(0,o.useCallback)(function(){var t=(0,f.Z)(m().mark((function t(e){var n,a;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.getTransaction(e);case 3:n=t.sent,a=Date.now(),i({type:"update_transaction",transactionResponse:n,lastUpdatedAt:a}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),[r,i]),u=(0,o.useCallback)((function(){for(var t,e=Date.now(),n=(0,d.Z)(c.transactions);!(t=n()).done;){var r=t.value;O(r,e)&&s(r.transactionHash)}}),[c.transactions,s]),l=(0,o.useCallback)((function(t){i({type:"add_transaction",transaction:t})}),[i]),p=(0,o.useCallback)((function(t){i({type:"remove_transaction",transactionHash:t})}),[i]),v=(0,o.useCallback)((function(t){s(t)}),[s]);return(0,o.useEffect)((function(){u();var t=setInterval((function(){u()}),null!=n?n:5e3);return function(){return clearInterval(t)}}),[n,u]),o.createElement(T.Provider,{value:{transactions:c.transactions.toArray(),addTransaction:l,removeTransaction:p,refreshTransaction:v}},e)}function D(t){var e=t.children;return o.createElement(x,null,o.createElement(N,null,o.createElement(j,null,e)))}var H={};function Z(t,e){return"set_call_response"===e.type?Object.assign({},t,{data:e.data,error:void 0,loading:!1}):"set_call_error"===e.type?Object.assign({},t,{error:e.error,loading:!1}):"set_last_updated_at"===e.type?Object.assign({},t,{loading:!1,lastUpdatedAt:e.blockHash}):t}function I(t){var e=t.contract,n=t.method,r=t.args,a=(0,o.useReducer)(Z,{loading:!0,lastUpdatedAt:""}),c=a[0],i=a[1],s=E().data,u=(0,o.useCallback)((0,f.Z)(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e&&n&&r)){t.next=4;break}return t.next=3,e.call(n,r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),[e,n,JSON.stringify(r)]),l=(0,o.useCallback)((function(){u().then((function(t){t&&i({type:"set_call_response",data:t})})).catch((function(t){t.message?i({type:"set_call_error",error:t.message}):i({type:"set_call_error",error:"call failed"})}))}),[u]);return(0,o.useEffect)((function(){null!=s&&s.block_hash&&(null==s?void 0:s.block_hash)!==c.lastUpdatedAt&&(l(),i({type:"set_last_updated_at",blockHash:s.block_hash}))}),[null==s?void 0:s.block_hash,c.lastUpdatedAt,l]),(0,o.useEffect)((function(){l()}),[null==e?void 0:e.address,n,JSON.stringify(r)]),{data:c.data,loading:c.loading,error:c.error,refresh:l}}function U(t){var e=t.abi,n=t.address,r=(0,o.useState)(void 0),a=r[0],c=r[1],i=_().library;return(0,o.useEffect)((function(){e&&n&&i&&c(new v.Contract(e,n,i))}),[e,n,i]),{contract:a}}function M(t,e){return"start_invoke"===e.type?Object.assign({},t,{loading:!0}):"set_invoke_response"===e.type?Object.assign({},t,{data:e.data.transaction_hash,error:void 0,loading:!1}):"set_invoke_error"===e.type?Object.assign({},t,{error:e.error,loading:!1}):"reset"===e.type?Object.assign({},t,{data:void 0,error:void 0,loading:!1}):t}function P(t){var e=t.contract,n=t.method,r=S().addTransaction,a=(0,o.useReducer)(M,{loading:!1}),c=a[0],i=a[1],s=(0,o.useCallback)((function(){i({type:"reset"})}),[i]),u=(0,o.useCallback)(function(){var t=(0,f.Z)(m().mark((function t(a){var o,c;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=a.args,!(e&&n&&o)){t.next=14;break}return t.prev=2,i({type:"start_invoke"}),t.next=6,e.invoke(n,o);case 6:c=t.sent,i({type:"set_invoke_response",data:c}),r({status:c.code,transactionHash:c.transaction_hash}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),t.t0.message?i({type:"set_invoke_error",error:t.t0.message}):i({type:"set_invoke_error",error:"invoke failed"});case 14:return t.abrupt("return",void 0);case 15:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}(),[e,n,r]);return{data:c.data,loading:c.loading,error:c.error,reset:s,invoke:u}}b(H,"useStarknetCall",(function(){return I})),b(H,"useContract",(function(){return U})),b(H,"useStarknetInvoke",(function(){return P}));var z={};b(z,"Connector",(function(){return B})),b(z,"InjectedConnector",(function(){return J}));var B=function(t){var e=t.options;this.options=e},L=(Error,function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this).name="ConnectorNotConnectedError",e.message="Connector not connected",e}return(0,u.Z)(e,t),e}((0,l.Z)(Error))),V=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this).name="ConnectorNotFoundError",e.message="Connector not found",e}return(0,u.Z)(e,t),e}((0,l.Z)(Error)),X=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this).name="UserRejectedRequestError",e.message="User rejected request",e}return(0,u.Z)(e,t),e}((0,l.Z)(Error)),J=function(t){function e(e){var n;return(n=t.call(this,{options:e})||this).id="injected",n.name="argent",n.starknet=(0,k.k)(),n}(0,u.Z)(e,t);var n=e.prototype;return n.connect=function(){var t=(0,f.Z)(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ready){t.next=2;break}throw new V;case 2:return t.prev=2,t.next=5,this.starknet.enable(this.options);case 5:t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(2),new X;case 10:if(this.starknet.isConnected){t.next=12;break}throw new X;case 12:return t.abrupt("return",this.starknet.account);case 13:case"end":return t.stop()}}),t,this,[[2,7]])})));return function(){return t.apply(this,arguments)}}(),n.account=function(){if(!e.ready)throw new V;return this.starknet.account?Promise.resolve(this.starknet.account):Promise.reject(new L)},e}(B);J.ready="undefined"!=typeof window&&!!window.starknet;var q=JSON.parse('[{"inputs":[{"name":"amount","type":"felt"}],"name":"incrementCounter","outputs":[{"name":"prev_count","type":"felt"},{"name":"new_count","type":"felt"}],"type":"function"},{"inputs":[],"name":"counter","outputs":[{"name":"count","type":"felt"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"lastCaller","outputs":[{"name":"address","type":"felt"}],"stateMutability":"view","type":"function"}]'),F=(0,i.zo)("div",{display:"flex",flexDirection:"column"}),G=(0,i.zo)("div",{}),Y=(0,i.zo)("h3",{}),K=(0,i.zo)("div",{display:"flex",justifyContent:"flex-start",gap:"4rem",marginBottom:"2rem"}),Q=(0,i.zo)("button",{background:"transparent",border:"1px solid var(--ifm-color-primary)",padding:"1rem",borderRadius:"10px",cursor:"pointer","&:hover":{boxShadow:"0px 5px 5px rgba(0, 0, 0, 0.2)"}});function W(){return U({abi:q,address:"0x036486801b8f42e950824cba55b2df8cccb0af2497992f807a7e1d9abd2c6ba1"})}function $(){var t=_(),e=t.account,n=t.connect;return o.createElement(G,null,o.createElement(Y,null,"Account"),o.createElement("div",null,o.createElement("p",null,"Connected Account: ",e)),J.ready?o.createElement(K,null,o.createElement(Q,{onClick:function(){return n(new J)}},"Connect Argent-X")):o.createElement("div",null,o.createElement("p",null,o.createElement("a",{href:"https://github.com/argentlabs/argent-x"},"Download Argent-X"))))}function tt(){var t=E(),e=t.data,n=t.error;return o.createElement(G,null,o.createElement(Y,null,"Block Data"),e?o.createElement("div",null,o.createElement("p",null,"Block Hash: ",e.block_hash),o.createElement("p",null,"Block Timestamp: ",new Date(1e3*e.timestamp).toLocaleString())):n?o.createElement("p",null,"'Error loading block data'"):o.createElement("p",null,"'Loading'"))}function et(){var t=I({contract:W().contract,method:"counter",args:[]}),e=t.data,n=t.error;return o.createElement(G,null,o.createElement(Y,null,"Contract Call"),e?o.createElement("div",null,o.createElement("p",null,"Counter Value: ",(0,s.toBN)(e[0]).toString())):n?o.createElement("p",null,"'Error loading counter'"):o.createElement("p",null,"'Loading'"))}function nt(){var t=P({contract:W().contract,method:"incrementCounter"}),e=t.data,n=t.loading,r=t.error,a=t.reset,c=t.invoke;return o.createElement(G,null,o.createElement(Y,null,"Invoke Contract Method"),o.createElement("div",null,e&&o.createElement("div",null,o.createElement("p",null,"Transaction Hash: ",e))),o.createElement("div",null,o.createElement("p",null,"Submitting: ",n?"Submitting":"Not Submitting"),o.createElement("p",null,"Error: ",r||"No error")),o.createElement(K,null,o.createElement(Q,{onClick:function(){return c({args:["0x1"]})}},"Invoke Method"),o.createElement(Q,{onClick:function(){return a()}},"Reset State")))}function rt(t){var e=t.transaction,n=t.onClick;return o.createElement("div",null,e.status,": ",e.transactionHash," ",o.createElement("button",{onClick:n},"remove"))}function at(){var t=S(),e=t.transactions,n=t.removeTransaction;return o.createElement(G,null,o.createElement(Y,null,"Transaction Manager"),o.createElement("div",null,0===e.length?"No transactions":e.map((function(t,e){return o.createElement(rt,{key:e,transaction:t,onClick:function(){return n(t.transactionHash)}})}))))}function ot(){return o.createElement(F,null,o.createElement($,null),o.createElement(tt,null),o.createElement(et,null),o.createElement(nt,null),o.createElement(at,null))}function ct(){return o.createElement(D,null,o.createElement(ot,null))}var it=["components"],st={},ut="StarkNet React Demo",lt={unversionedId:"demo",id:"demo",title:"StarkNet React Demo",description:"This demo shows how to combine the hooks provided by StarkNet React to",source:"@site/docs/demo.mdx",sourceDirName:".",slug:"/demo",permalink:"/starknet-react/demo",editUrl:"https://github.com/auclantis/starknet-react/tree/main/website/docs/demo.mdx",tags:[],version:"current",frontMatter:{}},dt=[],ft={toc:dt};function pt(t){var e=t.components,n=(0,a.Z)(t,it);return(0,c.kt)("wrapper",(0,r.Z)({},ft,n,{components:e,mdxType:"MDXLayout"}),(0,c.kt)("h1",{id:"starknet-react-demo"},"StarkNet React Demo"),(0,c.kt)("p",null,"This demo shows how to combine the hooks provided by StarkNet React to\nbuild React applications."),(0,c.kt)("p",null,"The demo interacts with a simple smart contract deployed on StarkNet G\xf6rli Testnet.\nYou can find the contract ",(0,c.kt)("a",{parentName:"p",href:"https://goerli.voyager.online/contract/0x036486801b8f42e950824cba55b2df8cccb0af2497992f807a7e1d9abd2c6ba1"},"on Voyager"),"."),(0,c.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,c.kt)("div",{parentName:"div",className:"admonition-heading"},(0,c.kt)("h5",{parentName:"div"},(0,c.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,c.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,c.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,c.kt)("div",{parentName:"div",className:"admonition-content"},(0,c.kt)("p",{parentName:"div"},"If you try to invoke the ",(0,c.kt)("inlineCode",{parentName:"p"},"incrementCounter")," method without first connecting Argent-X,\nthe transaction will fail instantly."))),(0,c.kt)(ct,{mdxType:"Demo"}))}pt.isMDXComponent=!0},5545:function(){},6047:function(){},4886:function(){},6601:function(){}}]);